<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <title>æˆ‘çš„ä¸–ç•Œåœ°åœ–</title>
    <link rel="stylesheet" href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css" />
    <style>
        body { margin: 0; display: flex; flex-direction: column; height: 100vh; font-family: sans-serif; }
        #header { background: #2c3e50; color: white; padding: 10px; text-align: center; }
        #main { display: flex; flex: 1; overflow: hidden; }
        #map { flex: 2; }
        #info-panel { flex: 1; padding: 20px; overflow-y: auto; background: #fff; border-left: 1px solid #ccc; }
        .country-flag { width: 100px; border: 1px solid #ddd; }
    </style>
</head>
<body>
    <div id="header"><h1>ğŸŒ äº’å‹•ä¸–ç•Œåœ°åœ–</h1></div>
    <div id="main">
        <div id="map"></div>
        <div id="info-panel"><p>é»æ“Šåœ°åœ–ä¸Šçš„åœ‹å®¶ä¾†æŸ¥çœ‹è³‡è¨Š...</p></div>
    </div>

    <script src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js"></script>
    <script>
        const map = L.map('map').setView([20, 0], 2);
        L.tileLayer('https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png').addTo(map);

        fetch('https://raw.githubusercontent.com/datasets/geo-countries/master/data/countries.geojson')
            .then(res => res.json())
            .then(data => {
                L.geoJSON(data, {
                    style: { color: "#3498db", weight: 1, fillOpacity: 0.2 },
                    onEachFeature: function (feature, layer) {
                        layer.on('click', function (e) {
                            map.fitBounds(e.target.getBounds());
                            updatePanel(feature.properties.ADMIN);
                        });
                    }
                }).addTo(map);
            });

        async function updatePanel(name) {
            const panel = document.getElementById('info-panel');
            panel.innerHTML = `<h2>${name}</h2><p>è®€å–ä¸­...</p>`;

            try {
                // æŠ“å–åœ‹å®¶åŸºæœ¬è³‡æ–™
                const res = await fetch(`https://restcountries.com/v3.1/name/${name}?fullText=true`);
                const cData = await res.json();
                const country = cData[0];

                // æŠ“å–ç¶­åŸºç™¾ç§‘ (è‹±æ–‡ API æ¯”è¼ƒç©©å®š)
                const wRes = await fetch(`https://en.wikipedia.org/api/rest_v1/page/summary/${encodeURIComponent(name)}`);
                const wData = await wRes.json();

                panel.innerHTML = `
                    <img class="country-flag" src="${country.flags.png}">
                    <h2>${name}</h2>
                    <p><b>é¦–éƒ½:</b> ${country.capital ? country.capital[0] : 'N/A'}</p>
                    <p><b>äººå£:</b> ${country.population.toLocaleString()}</p>
                    <hr>
                    <h3>ğŸ“œ æ­·å²èˆ‡ä»‹ç´¹</h3>
                    <p>${wData.extract || 'æš«ç„¡è³‡æ–™'}</p>
                `;
            } catch (err) {
                panel.innerHTML = `<h2>${name}</h2><p>ç„¡æ³•å–å¾—è©³ç´°è³‡æ–™ã€‚</p>`;
            }
        }
    </script>
</body>
</html>
