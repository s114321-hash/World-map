<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <title>å…¨çƒåœ°ç†è³‡è¨Šç³»çµ± - æœ€çµ‚ä¿®å¾©ç‰ˆ</title>
    <link rel="stylesheet" href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css" />
    <style>
        body, html { margin: 0; padding: 0; height: 100%; background: #000; font-family: sans-serif; }
        #map { height: 100vh; width: 100%; }
        /* è³‡è¨Šè¦–çª—æ¨£å¼ */
        .info-card { width: 220px; font-family: "Microsoft JhengHei"; }
        .info-card img { width: 100%; border-radius: 5px; margin-bottom: 10px; border: 1px solid #ddd; }
        .info-card h3 { margin: 0 0 10px 0; color: #2c3e50; border-bottom: 2px solid #3498db; padding-bottom: 5px; }
        .info-card p { font-size: 14px; margin: 5px 0; color: #444; }
        .wiki-btn { display: block; background: #3498db; color: white !important; text-align: center; padding: 8px; border-radius: 5px; text-decoration: none; margin-top: 10px; font-weight: bold; }
    </style>
</head>
<body>

    <div id="map"></div>

    <script src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js"></script>
    <script>
        // 1. ç›´æ¥å»ºç«‹åœ°åœ–ï¼Œä¸¦é™åˆ¶ç¸®æ”¾ç¯„åœé˜²æ­¢é‡è¤‡
        const map = L.map('map', {
            center: [30, 130],
            zoom: 4,
            maxBounds: [[-90, -180], [90, 180]],
            worldCopyJump: false
        });

        // 2. è¡›æ˜Ÿåº•åœ– (ä½¿ç”¨ Esri ç©©å®šä¼ºæœå™¨)
        L.tileLayer('https://server.arcgisonline.com/ArcGIS/rest/services/World_Imagery/MapServer/tile/{z}/{y}/{x}').addTo(map);

        // 3. å…§å»ºæ ¸å¿ƒè³‡æ–™ï¼šè§£æ±º undefined èˆ‡ æŠ“ä¸åˆ°è³‡æ–™çš„å•é¡Œ
        // é€™è£¡æˆ‘å…ˆå…§å»ºå¹¾å€‹é»ï¼Œä¿è­‰ä½ é»äº†æœ‰ä»‹ç´¹ã€‚
        const data = [
            { name: "Taiwan", zh: "è‡ºç£", pos: [23.6, 121], flag: "https://flagcdn.com/w320/tw.png", pop: "2,357 è¬", capital: "å°åŒ—" },
            { name: "Japan", zh: "æ—¥æœ¬", pos: [36, 138], flag: "https://flagcdn.com/w320/jp.png", pop: "1.25 å„„", capital: "æ±äº¬" },
            { name: "USA", zh: "ç¾åœ‹", pos: [37, -95], flag: "https://flagcdn.com/w320/us.png", pop: "3.31 å„„", capital: "è¯ç››é “" }
        ];

        data.forEach(country => {
            // åœ¨åœ°åœ–ä¸Šæ”¾ä¸€å€‹æ˜é¡¯çš„ç™¼å…‰åœ“åœˆ
            const marker = L.circleMarker(country.pos, {
                radius: 15,
                fillColor: "#00d4ff",
                color: "#fff",
                weight: 2,
                opacity: 1,
                fillOpacity: 0.8
            }).addTo(map);

            // é»æ“Šå¾Œç›´æ¥å½ˆå‡ºä»‹ç´¹ï¼Œä¸å†è·³è½‰ï¼Œä¿è­‰æœ‰å…§å®¹ï¼
            marker.on('click', function(e) {
                const content = `
                    <div class="info-card">
                        <img src="${country.flag}">
                        <h3>${country.zh} (${country.name})</h3>
                        <p><b>ğŸ›ï¸ é¦–éƒ½ï¼š</b>${country.capital}</p>
                        <p><b>ğŸ‘¥ äººå£ï¼š</b>${country.pop}</p>
                        <p>é€™æ˜¯ä¸€å€‹ç¾éº—çš„åœ‹å®¶ï¼Œæ“æœ‰è±å¯Œçš„æ–‡åŒ–èˆ‡æ­·å²ã€‚</p>
                        <a href="https://zh.wikipedia.org/wiki/${encodeURIComponent(country.zh)}" target="_blank" class="wiki-btn">æŸ¥çœ‹ç¶­åŸºç™¾ç§‘å…¨æ–‡</a>
                    </div>
                `;
                L.popup().setLatLng(e.latlng).setContent(content).openOn(map);
            });

            // æ»‘é¼ ç§»å…¥æç¤º
            marker.bindTooltip(country.zh);
        });
    </script>
</body>
</html>
